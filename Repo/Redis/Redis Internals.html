
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Redis Internals ‚Äì Interview Deep Dive</title>

    <style>
        body {
            font-family: "Segoe UI", Roboto, Arial, sans-serif;
            background: #f7f8fa;
            color: #1f2937;
            line-height: 1.65;
            margin: 0;
            padding: 32px;
        }

        .container {
            max-width: 1100px;
            margin: auto;
            background: #ffffff;
            padding: 40px 48px;
            border-radius: 16px;
            box-shadow: 0 12px 32px rgba(0,0,0,0.08);
        }

        h1 {
            text-align: center;
            margin-bottom: 42px;
            color: #0f172a;
        }

        h2 {
            margin-top: 46px;
            color: #2563eb;
            border-left: 6px solid #2563eb;
            padding-left: 14px;
        }

        h3 {
            margin-top: 22px;
            color: #111827;
        }

        p {
            margin: 8px 0;
        }

        ul {
            margin: 10px 0 20px 28px;
        }

        li {
            margin-bottom: 6px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 14px;
            background: #ffffff;
        }

        th, td {
            border: 1px solid #e5e7eb;
            padding: 10px;
            text-align: left;
        }

        th {
            background: #f1f5f9;
        }

        pre {
            background: #0f172a;
            color: #e5e7eb;
            padding: 18px;
            border-radius: 12px;
            overflow-x: auto;
            margin: 18px 0;
            font-size: 14px;
        }

        code {
            font-family: Consolas, monospace;
        }

        .note {
            background: #fef3c7;
            border-left: 6px solid #f59e0b;
            padding: 16px 18px;
            margin: 20px 0;
            border-radius: 10px;
        }

        .success {
            background: #dcfce7;
            border-left: 6px solid #22c55e;
            padding: 16px 18px;
            margin: 20px 0;
            border-radius: 10px;
        }

        .danger {
            background: #fee2e2;
            border-left: 6px solid #ef4444;
            padding: 16px 18px;
            margin: 20px 0;
            border-radius: 10px;
        }

        .divider {
            margin: 40px 0;
            border-top: 1px dashed #e5e7eb;
        }

        .footer {
            margin-top: 56px;
            padding-top: 28px;
            border-top: 1px solid #e5e7eb;
            text-align: center;
            font-size: 14px;
            color: #6b7280;
        }
    </style>
</head>

<body>

<div class="container">

<h1>üî• Redis Internals ‚Äî Interview Deep Dive</h1>

<h2>1Ô∏è‚É£ What is Redis?</h2>

<h3>Basic</h3>
<p>
Redis = <strong>REmote DIctionary Server</strong><br>
An <strong>in-memory key-value data store</strong> used for:
</p>

<ul>
    <li>Caching</li>
    <li>Sessions</li>
    <li>Rate limiting</li>
    <li>Pub/Sub</li>
    <li>Leaderboards</li>
</ul>

<h3>Advanced</h3>
<ul>
    <li>Single-threaded event loop</li>
    <li>In-memory first, disk persistence optional</li>
    <li>Sub-millisecond latency</li>
    <li>Non-blocking I/O (epoll)</li>
</ul>

<div class="note">
    Redis is single-threaded to avoid locks, ensure predictable latency,
    and achieve high throughput.
</div>

<div class="divider"></div>

<h2>2Ô∏è‚É£ Redis Data Structures</h2>

<table>
    <tr>
        <th>Redis Type</th>
        <th>Java Equivalent</th>
        <th>Use Case</th>
    </tr>
    <tr><td>String</td><td>String</td><td>Cache values</td></tr>
    <tr><td>Hash</td><td>Map</td><td>User sessions</td></tr>
    <tr><td>List</td><td>Deque</td><td>Queues</td></tr>
    <tr><td>Set</td><td>Set</td><td>Deduplication</td></tr>
    <tr><td>Sorted Set</td><td>TreeSet</td><td>Leaderboards</td></tr>
    <tr><td>Bitmap</td><td>BitSet</td><td>Feature flags</td></tr>
    <tr><td>HyperLogLog</td><td>Approx Set</td><td>Unique counts</td></tr>
</table>

<pre>
SET user:1 "Akhil"
HSET session:123 userId 1 role ADMIN
</pre>

<div class="divider"></div>

<h2>3Ô∏è‚É£ Redis Architecture</h2>

<pre>
Client
  ‚Üì
Event Loop (epoll)
  ‚Üì
In-Memory Data Store
  ‚Üì
Persistence (Optional)
</pre>

<ul>
    <li>Single-threaded event loop</li>
    <li>Command queue</li>
    <li>jemalloc memory allocator</li>
    <li>TTL expiry dictionary</li>
</ul>

<div class="divider"></div>

<h2>4Ô∏è‚É£ Redis Persistence</h2>

<h3>RDB (Snapshot)</h3>
<ul>
    <li>Periodic snapshots</li>
    <li>Fast restart</li>
    <li>Possible data loss</li>
</ul>

<pre>save 900 1</pre>

<h3>AOF (Append Only File)</h3>
<ul>
    <li>Logs every write</li>
    <li>Safer</li>
    <li>Slightly slower</li>
</ul>

<pre>appendonly yes</pre>

<div class="note">
    Production systems typically use <strong>AOF + RDB</strong> together.
</div>

<div class="divider"></div>

<h2>5Ô∏è‚É£ Replication & Clustering</h2>

<h3>Replication</h3>
<ul>
    <li>One master</li>
    <li>Multiple replicas</li>
    <li>Asynchronous replication</li>
</ul>

<h3>Redis Cluster</h3>
<ul>
    <li>16384 hash slots</li>
    <li>Horizontal scaling</li>
    <li>No single point of failure</li>
</ul>

<div class="divider"></div>

<h2>6Ô∏è‚É£ Expiry & Eviction</h2>

<pre>SET key value EX 60</pre>

<table>
    <tr><th>Policy</th><th>Meaning</th></tr>
    <tr><td>LRU</td><td>Least Recently Used</td></tr>
    <tr><td>LFU</td><td>Least Frequently Used</td></tr>
    <tr><td>noeviction</td><td>Error on insert</td></tr>
</table>

<div class="note">
    Redis does NOT evict randomly by default.
</div>

<div class="divider"></div>

<h2>7Ô∏è‚É£ Why Redis for Rate Limiting?</h2>

<ul>
    <li>Atomic operations</li>
    <li>No race conditions</li>
    <li>TTL support</li>
    <li>Extremely fast</li>
</ul>

<div class="divider"></div>

<h1>üö¶ Rate Limiter Using Redis</h1>

<h2>Problem</h2>
<p><strong>100 requests per minute per IP</strong></p>

<h2>Approach Options</h2>

<table>
    <tr><th>Strategy</th><th>Accuracy</th><th>Complexity</th></tr>
    <tr><td>Fixed Window</td><td>Low</td><td>Easy</td></tr>
    <tr><td>Sliding Window</td><td>High</td><td>Medium</td></tr>
    <tr><td>Token Bucket</td><td>Very High</td><td>Hard</td></tr>
    <tr><td>Leaky Bucket</td><td>High</td><td>Hard</td></tr>
</table>

<div class="divider"></div>

<h2>Sliding Window (Interview Favorite)</h2>

<pre>
ZADD rate:ip timestamp timestamp
ZREMRANGEBYSCORE rate:ip 0 (now - window)
ZCARD rate:ip
</pre>

<pre>
String key = "rate:" + ip;
long now = System.currentTimeMillis();

redis.opsForZSet().add(key, now, now);
redis.opsForZSet().removeRangeByScore(key, 0, now - 60000);

Long count = redis.opsForZSet().zCard(key);
if (count > 100) throw new RateLimitException();
</pre>

<div class="success">
    ‚úî Accurate<br>
    ‚úî Smooth throttling<br>
    ‚úî Industry standard
</div>

<div class="divider"></div>

<h2>Token Bucket (Senior-Level)</h2>

<pre>
-- Lua script ensures atomicity
local tokens = redis.call("GET", KEYS[1])
</pre>

<div class="note">
    Lua scripts guarantee atomic execution and prevent race conditions.
</div>

<div class="divider"></div>

<h2>üéØ Perfect Interview Answer</h2>

<div class="success">
    Redis is an in-memory, single-threaded data store optimized for fast atomic operations.
    It is ideal for rate limiting using counters or sorted sets.
    For accuracy, sliding window or token bucket algorithms with Redis and Lua are used.
</div>

<div class="footer">
    ¬© Redis Internals & Rate Limiting ‚Äî Interview Ready
</div>

</div>

</body>
</html>


